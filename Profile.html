<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Itemslist</title>
  <link href="ProfileCss.css" rel="stylesheet" type="text/css"/>
  <link rel="icon" type="image/x-icon" href="Images/newlogo.png">

  <!--Google Fonts-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
</head>
<body onload="GetHistory()">
    <nav>
    <!--KTI Logo and Title-->
    <p class="navMainText">
      <img id="navImage" src="Images/newlogo.png" width="100" alt="drawing of a welder">
      Keefe Tech Inventory
    </p>

    <br>

    <!--Navigation Bar-->
    <div class="topnav" id="myTopnav">
      <a href="../class.html"><b><i>CLASSES</a></b></i>
      <a href="#items"><b><i>ITEMS</a></b></i>
    </div>
  </nav>
    <h1 class="profileTitle"><i>Manage Your Account</i></h1>
    <div class="profileContainer">
        <div class="profileDetails">
            <h2><i>Name:</i> Jam</h2>
            <h2><i>Email:</i></h2>
            <h2><i>Account Type:</i> Student Account</h2>
        </div>
        <div class="profilePicture">
            <img src="Images/metalIcon.jpg" width="150" alt="placeholder">
        </div>
    </div>
    <div class="historySection">
        <h2><i>History</i></h2>
        <div class="historyContainer" id="historyContainer">
            <!-- History items will be appended here -->
        </div>
    </div>
    <script>
        async function GetHistory(){
            const History = document.getElementById("historyContainer");
            try {
            const response = await fetch("https://develmets.skiscratcher.com/getMyHistory", {
                method: "GET",
                credentials: "include"
            });
            if (!response.ok) 
            History.innerHTML = "<h3><i>No History Found</i></h3>";
            return;
            const assigned = await response.json();
            console.log(assigned);
            

            assigned.forEach(historyItem => {
            const row = document.createElement("div");
            row.className = "historyRow";
            row.style.display = "flex";
            row.style.alignItems = "center";
            row.style.marginBottom = "8px";

            row.innerHTML = `
                <div style="flex: 1;"><i>Item Name:</i> ${historyItem.toolId}</div>
                <div style="flex: 1;"><i>Time Taken:</i> ${historyItem.timeTaken}</div>
                <div style="flex: 1;"><i>Time Returned:</i> ${new Date(historyItem.timeReturned).toLocaleString()}</div>
            `;
            History.appendChild(row);
            });
            } catch (err) {
            // Ignore errors for now
            }

            async function fetchTools() {
            try {
            const response = await fetch("https://develmets.skiscratcher.com/getTools", {
                method: "GET",
                credentials: "include"
            });
            if (!response.ok) return;
            const fetched = await response.json();
            // store the tools array (replace contents)
            tools.length = 0;
            fetched.forEach(t => tools.push(t));
            } catch (err) {
            // silently ignore network errors for now â€” UI will simply show no tools
            }
        }

        }
    </script>
</body>
</html>